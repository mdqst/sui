// Copyright (c) Mysten Labs, Inc.
// SPDX-License-Identifier: Apache-2.0

#[allow(implicit_const_copy)]
#[test_only]
module sui::attestation_tests {
    use sui::attestation;
    
    #[test]
    fun test_attestation_verify() {
        let attestation = x"8444a1013822a0591120a9696d6f64756c655f69647827692d30663733613462346362373463633966322d656e633031393265343138386665663738316466646967657374665348413338346974696d657374616d701b00000192e880646a6470637273b0005830000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000015830000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000025830000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000035830639a8b65f68b0223cbb14a0032487e5656d260434e3d1a10e7ec1407fb86143860717fc8afee90df7a1604111709af460458309ab5a1aba055ee41ee254b9b251a58259b29fa1096859762744e9ac73b5869b25e51223854d9f86adbb37fe69f3e5d1c0558300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000658300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000758300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000858300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000958300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a58300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b58300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c58300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d58300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e58300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f58300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006b63657274696669636174655902803082027c30820201a00302010202100192e4188fef781d000000006724fe0d300a06082a8648ce3d04030330818e310b30090603550406130255533113301106035504080c0a57617368696e67746f6e3110300e06035504070c0753656174746c65310f300d060355040a0c06416d617a6f6e310c300a060355040b0c034157533139303706035504030c30692d30663733613462346362373463633966322e75732d656173742d312e6177732e6e6974726f2d656e636c61766573301e170d3234313130313136313235385a170d3234313130313139313330315a308193310b30090603550406130255533113301106035504080c0a57617368696e67746f6e3110300e06035504070c0753656174746c65310f300d060355040a0c06416d617a6f6e310c300a060355040b0c03415753313e303c06035504030c35692d30663733613462346362373463633966322d656e63303139326534313838666566373831642e75732d656173742d312e6177733076301006072a8648ce3d020106052b81040022036200048531c70a57ac1c47863824cd12b2c861811597a7d7c5fed67f749c28b0cb81f30df12a9f119051dba22b9d4f0610a1bfabe46b47d7ab8ba051c68354e0909b00783cb0de9cddbb6069950865cb646f4bba85290d924381917f7717e72b40ace9a31d301b300c0603551d130101ff04023000300b0603551d0f0404030206c0300a06082a8648ce3d04030303690030660231008020e8ad8ada331970db95a8ab5686ed0eb3334e9fc54e7de231c2414034617978dd60472569ef55e902910a4ec8ab05023100dad483a9cb917e4de9bd9a34d02cb00aa07ffe7770da6e53b827104c31cd9b9c187a07eace195ab7809bb8f5c0122ae968636162756e646c65845902153082021130820196a003020102021100f93175681b90afe11d46ccb4e4e7f856300a06082a8648ce3d0403033049310b3009060355040613025553310f300d060355040a0c06416d617a6f6e310c300a060355040b0c03415753311b301906035504030c126177732e6e6974726f2d656e636c61766573301e170d3139313032383133323830355a170d3439313032383134323830355a3049310b3009060355040613025553310f300d060355040a0c06416d617a6f6e310c300a060355040b0c03415753311b301906035504030c126177732e6e6974726f2d656e636c617665733076301006072a8648ce3d020106052b8104002203620004fc0254eba608c1f36870e29ada90be46383292736e894bfff672d989444b5051e534a4b1f6dbe3c0bc581a32b7b176070ede12d69a3fea211b66e752cf7dd1dd095f6f1370f4170843d9dc100121e4cf63012809664487c9796284304dc53ff4a3423040300f0603551d130101ff040530030101ff301d0603551d0e041604149025b50dd90547e796c396fa729dcf99a9df4b96300e0603551d0f0101ff040403020186300a06082a8648ce3d0403030369003066023100a37f2f91a1c9bd5ee7b8627c1698d255038e1f0343f95b63a9628c3d39809545a11ebcbf2e3b55d8aeee71b4c3d6adf3023100a2f39b1605b27028a5dd4ba069b5016e65b4fbde8fe0061d6a53197f9cdaf5d943bc61fc2beb03cb6fee8d2302f3dff65902c1308202bd30820244a00302010202105e38d80df50697821a75868f41e784b0300a06082a8648ce3d0403033049310b3009060355040613025553310f300d060355040a0c06416d617a6f6e310c300a060355040b0c03415753311b301906035504030c126177732e6e6974726f2d656e636c61766573301e170d3234313032393039303734355a170d3234313131383130303734355a3064310b3009060355040613025553310f300d060355040a0c06416d617a6f6e310c300a060355040b0c034157533136303406035504030c2d616662353333343262366335383838352e75732d656173742d312e6177732e6e6974726f2d656e636c617665733076301006072a8648ce3d020106052b8104002203620004c92eff4f5268be6b0b2d5e402610285410046d5ff1ccbbada2cafac96ca22525a89d710bc69c6dddf1c5dde1bb29293416611718f47631c5c61945d82ad49c41a553af78f409763490a3f888edf8188fee6d6691aeba6faf3a559d1086f7437fa381d53081d230120603551d130101ff040830060101ff020102301f0603551d230418301680149025b50dd90547e796c396fa729dcf99a9df4b96301d0603551d0e041604144cb4eb898e87a14e9b196cc57923aa7899c45454300e0603551d0f0101ff040403020186306c0603551d1f046530633061a05fa05d865b687474703a2f2f6177732d6e6974726f2d656e636c617665732d63726c2e73332e616d617a6f6e6177732e636f6d2f63726c2f61623439363063632d376436332d343262642d396539662d3539333338636236376638342e63726c300a06082a8648ce3d0403030367003064023064ff9e5be5f0028e5cd81103213d49839330fcf2110d9e53bb4149fd71e86576ac27c53e886a92081bef34a006b2bead02300a6a31d99fe753f0b582f1ee81975e7c81bfb7a31bac3f41f0456107cb0c4442bfb644f8c672b322fd415b5445021210590318308203143082029aa0030201020210656eddc68ca271e0d87e4556975c6e4a300a06082a8648ce3d0403033064310b3009060355040613025553310f300d060355040a0c06416d617a6f6e310c300a060355040b0c034157533136303406035504030c2d616662353333343262366335383838352e75732d656173742d312e6177732e6e6974726f2d656e636c61766573301e170d3234313130313035353131315a170d3234313130363230353131305a308189313c303a06035504030c33343431653935346366616137656561382e7a6f6e616c2e75732d656173742d312e6177732e6e6974726f2d656e636c61766573310c300a060355040b0c03415753310f300d060355040a0c06416d617a6f6e310b3009060355040613025553310b300906035504080c0257413110300e06035504070c0753656174746c653076301006072a8648ce3d020106052b81040022036200040b7dbaa561f8294f9fba1727c2ecc0bab4abb27d2e04c6a255a4f9ad3e7471e34e32f630e6228552ba684289b6e9ba065484f02fdd29b802f150ad4f3cb3beb5032a96126d223f34ae9430a5152bbcfd4eb1665c6c3e19bbbe8688c8b77900a8a381ea3081e730120603551d130101ff040830060101ff020101301f0603551d230418301680144cb4eb898e87a14e9b196cc57923aa7899c45454301d0603551d0e0416041457eb5d610ec8aeae89028cabb14bdf3672b0ff07300e0603551d0f0101ff0404030201863081800603551d1f047930773075a073a071866f687474703a2f2f63726c2d75732d656173742d312d6177732d6e6974726f2d656e636c617665732e73332e75732d656173742d312e616d617a6f6e6177732e636f6d2f63726c2f66316139303335362d616130622d343934332d613866612d3933613737623036396361332e63726c300a06082a8648ce3d040303036800306502310091f43592545b55ae03ae0dd8233541cf9d21f649a7037e5ff5d09ed3fb459a036727ee07550c9424a6b67040327433c3023001e650662d8435ef39a7c982585b791fa61776d168ebe6295899d68c0d6f19f3e3a1b694f7ca6de6113c51f734627c245902c3308202bf30820245a003020102021500fe7e5aff7f6277a3c929ad170a5c6362fc1d673d300a06082a8648ce3d040303308189313c303a06035504030c33343431653935346366616137656561382e7a6f6e616c2e75732d656173742d312e6177732e6e6974726f2d656e636c61766573310c300a060355040b0c03415753310f300d060355040a0c06416d617a6f6e310b3009060355040613025553310b300906035504080c0257413110300e06035504070c0753656174746c65301e170d3234313130313130313030395a170d3234313130323130313030395a30818e310b30090603550406130255533113301106035504080c0a57617368696e67746f6e3110300e06035504070c0753656174746c65310f300d060355040a0c06416d617a6f6e310c300a060355040b0c034157533139303706035504030c30692d30663733613462346362373463633966322e75732d656173742d312e6177732e6e6974726f2d656e636c617665733076301006072a8648ce3d020106052b81040022036200040fe46adf864a558a00a9ca4b64ece5ba124ed1d29656a1f16ca71d0dc8fca56b0fb15aafd309f6258374e8c7b4a5b0521c76d1812a7873474dae9322aef1cd782db19fc2ece4d36fa08acbe65e4bec2a3cfe70960d179778ea7e7711f827b36ea366306430120603551d130101ff040830060101ff020100300e0603551d0f0101ff040403020204301d0603551d0e041604143e40d423bf86e9565c378487843389bd2f471a56301f0603551d2304183016801457eb5d610ec8aeae89028cabb14bdf3672b0ff07300a06082a8648ce3d0403030368003065023100a3a08f56bc0c28b93d7e13258e497b9ea3245a4c9a56c7271cf545a86d0b09482ceecc7fdb1e5bcdc739def92a4ed8cd02303c384850b6188959b9f1114253376464573563d77e1c6812b1998bf960da478b0cea959f34a8201bf779a8ae615f4d266a7075626c69635f6b6579f669757365725f6461746158205a264748a62368075d34b9494634a3e096e0e48f6647f965b81d2a653de684f2656e6f6e6365f65860ae4af5ff7bf5ff9cb507cde57dcb5e6abf98bb85437387cb01aa7b337be53f12118c401ac3d1f45211f9ad2a8f50460aee13d59731ca3c0764df25d408ed2250064ea84844cb61e6cbe0a8b0ae27a7a99ccce69891616ac097018abbfe1d7324";
        let enclave_pk = x"5a264748a62368075d34b9494634a3e096e0e48f6647f965b81d2a653de684f2";
        let pcr0 = x"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
        let pcr1 = x"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
        let pcr2 = x"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
        let verify = attestation::nitro_attestation_verify(&attestation, &enclave_pk, &pcr0, &pcr1, &pcr2);
        assert!(verify == true)
    }
}
